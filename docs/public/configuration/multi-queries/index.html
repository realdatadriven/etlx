<!DOCTYPE html>
<html
  lang="en-US"
  dir="ltr"
><head><script src="/etlx/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=etlx/livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="/favicon.ico"><link rel="preload" href="/icons/clipboard.svg" as="image" type="image/svg+xml" />
<link rel="preload" href="/icons/caret-down.svg" as="image" type="image/svg+xml" />
<link rel="preload" href="/icons/caret-right.svg" as="image" type="image/svg+xml" />
<link rel="preload" href="/icons/home.svg" as="image" type="image/svg+xml" />
<title>Multi-Queries | Plume</title>
  <meta name="description" content="The Plume Hugo documentation theme">
  <meta name="keywords" content="Plume, Hugo, documentation, theme">
  <meta name="author" content="Dobefu">
  <meta name="language" content="en-US">

  <link rel="canonical" href="http://localhost:1313/etlx/configuration/multi-queries/">
  <link rel="manifest" href="http://localhost:1313/etlx/manifest.webmanifest"><meta property="og:title" content="Multi-Queries | Plume">
  <meta property="og:description" content="The Plume Hugo documentation theme">
  <meta property="og:type" content="article">
  <meta property="og:url" content="http://localhost:1313/etlx/configuration/multi-queries/">
  <meta property="og:locale" content="en-US">
  <meta property="og:site_name" content="Plume">
  <meta property="og:image" content="http://localhost:1313/favicon.ico">
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="512">
  <meta property="og:image:alt" content="Plume logo"><meta property="article:author" content="Dobefu"><meta property="article:section" content="configuration"><meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Multi-Queries | Plume">
  <meta name="twitter:description" content="The Plume Hugo documentation theme">
  <meta name="twitter:image" content="http://localhost:1313/favicon.ico">
  <meta name="twitter:image:alt" content="Plume logo"><script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "TechArticle",
        "@id": "http:\/\/localhost:1313\/etlx\/configuration\/multi-queries\/#article",
        "headline": "Multi-Queries",
        "description": "The Plume Hugo documentation theme",
        "url": "http:\/\/localhost:1313\/etlx\/configuration\/multi-queries\/",
        "datePublished": "0001-01-01T00:00:00Z",
        "dateModified": "0001-01-01T00:00:00Z",
        "wordCount":  566 ,
        "timeRequired": "PT3M",
        "author": {
          "@type": "Organization",
          "@id": "http:\/\/localhost:1313\/etlx\/#organization"
        },
        "publisher": {
          "@type": "Organization",
          "@id": "http:\/\/localhost:1313\/etlx\/#organization"
        },
        "isPartOf": {
          "@id": "http:\/\/localhost:1313\/etlx\/#website"
        }
      },{
        "@type": "BreadcrumbList",
        "@id": "http:\/\/localhost:1313\/etlx\/configuration\/multi-queries\/#breadcrumb",
        "itemListElement": [{
              "@type": "ListItem",
              "position":  1 ,
              "name": "Plume Documentation Theme",
              "item": "http:\/\/localhost:1313\/etlx\/"
            },{
              "@type": "ListItem",
              "position":  2 ,
              "name": "Configuration",
              "item": "http:\/\/localhost:1313\/etlx\/configuration\/"
            },{
              "@type": "ListItem",
              "position":  3 ,
              "name": "Multi-Queries",
              "item": "http:\/\/localhost:1313\/etlx\/configuration\/multi-queries\/"
            }]
      },{
        "@type": "WebSite",
        "@id": "http:\/\/localhost:1313\/etlx\/#website",
        "url": "http:\/\/localhost:1313\/etlx\/",
        "name": "Plume",
        "publisher": {
          "@id": "http:\/\/localhost:1313\/etlx\/#organization"
        }
      }
    ]
  }
</script>
<link rel="stylesheet" href="/etlx/css/_reset.css"><link rel="stylesheet" href="/etlx/css/base.css"><link rel="stylesheet" href="/etlx/css/breadcrumbs.css"><link rel="stylesheet" href="/etlx/css/card.css"><link rel="stylesheet" href="/etlx/css/content.css"><link rel="stylesheet" href="/etlx/css/edit-link.css"><link rel="stylesheet" href="/etlx/css/fonts.css"><link rel="stylesheet" href="/etlx/css/footer.css"><link rel="stylesheet" href="/etlx/css/form.css"><link rel="stylesheet" href="/etlx/css/header.css"><link rel="stylesheet" href="/etlx/css/headings.css"><link rel="stylesheet" href="/etlx/css/highlight-copy.css"><link rel="stylesheet" href="/etlx/css/highlight.css"><link rel="stylesheet" href="/etlx/css/page.css"><link rel="stylesheet" href="/etlx/css/search.css"><link rel="stylesheet" href="/etlx/css/sidebar.css"><link rel="stylesheet" href="/etlx/css/skip-link.css"><link rel="stylesheet" href="/etlx/css/table.css"><link rel="stylesheet" href="/etlx/css/toc.css"><link rel="stylesheet" href="/etlx/css/variables.css"></head>
<body
    class="has-toc has-sidebar"
  ><a class="skip-link" href="#main-content">Skip to main content</a>
<header class="header"><button
      class="header__sidebar--toggle"
      data-action="toggle-sidebar"
      title="Toggle sidebar"
    ></button><a class="header__title" href="/">Plume</a><nav class="menu">
    <ul><li>
      <a href="/etlx/">Home</a></li><li>
      <a href="/etlx/docs/">Documentation</a></li><li>
      <a href="/etlx/introduction/">Introduction</a></li><li>
      <a href="/etlx/quick-start/">Quick Start</a></li><li>
      <a href="/etlx/configuration/">Configuration</a></li><li>
      <a href="/etlx/advanced/">Advanced</a></li><li>
      <a href="/etlx/embedding/">Embedding</a></li><li>
      <a href="/etlx/future/">Future</a></li><li>
      <a href="/etlx/license/">License</a></li></ul>
  </nav><button
    class="header__menu--toggle"
    data-action="toggle-menu"
    title="Toggle menu"
  ></button>
</header>
<div class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList"><a
          class="crumb home"
          href="http://localhost:1313/etlx/"
          title="Plume Documentation Theme"
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
        ><meta itemprop="item" content="http://localhost:1313/etlx/"><span itemprop="name">Plume Documentation Theme</span><meta itemprop="position" content="1"></a><a
          class="crumb"
          href="http://localhost:1313/etlx/configuration/"
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
        ><meta itemprop="item" content="http://localhost:1313/etlx/configuration/"><span itemprop="name">Configuration</span><meta itemprop="position" content="2"></a><span
          class="crumb current"
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
        ><meta itemprop="item" content="http://localhost:1313/etlx/configuration/multi-queries/"><span itemprop="name">Multi-Queries</span><meta itemprop="position" content="3"></span></div><aside class="sidebar">
    <div class="sidebar__content">
      <button
        class="sidebar__close"
        data-action="toggle-sidebar"
        title="Close sidebar"
      ></button>

      <div class="sidebar__section--search">
        <input
          name="q"
          placeholder="Search..."
          type="search"
        />
        <ul class="sidebar__section--search-results"></ul>
      </div>

      <nav class="sidebar__nav">
        <ul class="sidebar__section--pages"><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/etl/"
      >ETL</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/validation/"
      >Validation Rules</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/query-doc/"
      >Query Documentation</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/data-quality/"
      >Data Quality</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/exports/"
      >Exports</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/scripts/"
      >Scripts</a>
    </li><li>
      <a
        class="sidebar__link is-active"
        href="http://localhost:1313/etlx/configuration/multi-queries/"
      >Multi-Queries</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/logs/"
      >Logs</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/requires/"
      >Loading Config Dependencies</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/actions/"
      >Actions</a>
    </li><li>
      <a
        class="sidebar__link"
        href="http://localhost:1313/etlx/configuration/notify/"
      >Notify</a>
    </li></ul>
      </nav>
    </div><footer class="footer">
    <div class="footer__social-links"><a href="https://github.com/Dobefu/hugo-theme-plume" target="_blank" rel="noopener noreferrer"><div title="GitHub">
              <div aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M5.315 2.1c.791-.113 1.9.145 3.333.966l.272.161l.16.1l.397-.083a13.3 13.3 0 0 1 4.59-.08l.456.08l.396.083l.161-.1c1.385-.84 2.487-1.17 3.322-1.148l.164.008l.147.017l.076.014l.05.011l.144.047a1 1 0 0 1 .53.514a5.2 5.2 0 0 1 .397 2.91l-.047.267l-.046.196l.123.163c.574.795.93 1.728 1.03 2.707l.023.295L21 9.5c0 3.855-1.659 5.883-4.644 6.68l-.245.061l-.132.029l.014.161l.008.157l.004.365l-.002.213L16 21a1 1 0 0 1-.883.993L15 22H9a1 1 0 0 1-.993-.883L8 21v-.734c-1.818.26-3.03-.424-4.11-1.878l-.535-.766c-.28-.396-.455-.579-.589-.644l-.048-.019a1 1 0 0 1 .564-1.918c.642.188 1.074.568 1.57 1.239l.538.769c.76 1.079 1.36 1.459 2.609 1.191L8 17.562l-.018-.168a5 5 0 0 1-.021-.824l.017-.185l.019-.12l-.108-.024c-2.976-.71-4.703-2.573-4.875-6.139l-.01-.31L3 9.5a5.6 5.6 0 0 1 .908-3.051l.152-.222l.122-.163l-.045-.196a5.2 5.2 0 0 1 .145-2.642l.1-.282l.106-.253a1 1 0 0 1 .529-.514l.144-.047z"/></svg>
</div>
            </div></a></div>
  </footer></aside>

  <div class="sidebar__backdrop" data-action="toggle-sidebar"></div><main id="main-content"><h1>Multi-Queries</h1><h3 id="multi-queries">Multi-Queries</h3>
<p>The <code>MULTI_QUERIES</code> section allows you to define multiple queries with similar structures and aggregate their results using a SQL <code>UNION</code>. This is particularly useful when generating summaries or reports that combine data from multiple queries into a single result set.</p>
<hr>
<h4 id="multi-queries-structure"><strong>Multi-Queries Structure</strong></h4>
<ol>
<li>
<p><strong>Metadata</strong>:</p>
<ul>
<li>The <code>MULTI_QUERIES</code> section includes metadata for connection details, pre/post-SQL commands, and activation status.</li>
<li>The <code>union_key</code> defines how the queries are combined (e.g., <code>UNION</code>, <code>UNION ALL</code>).</li>
</ul>
</li>
<li>
<p><strong>Query Definitions</strong>:</p>
<ul>
<li>Each query is defined as a Level 2 heading under the <code>MULTI_QUERIES</code> block.</li>
<li>Queries inherit metadata from the parent block unless overridden.</li>
</ul>
</li>
<li>
<p><strong>Execution</strong>:</p>
<ul>
<li>All queries are combined using the specified <code>union_key</code> (default is <code>UNION</code>).</li>
<li>The combined query is executed as a single statement.</li>
<li>The combined query can be save by specifying <code>save_sql</code> normally an insert, create [or replace] table or even a copy to file statement, and insert statement should be used in combination with the <code>save_on_err_patt</code> and <code>save_on_err_sql</code> in case of an error matching the <code>table does ... not exist</code> to create the table instead.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="multi-queries-markdown-example"><strong>Multi-Queries Markdown Example</strong></h4>
<figure class="code-block" role="figure" aria-label="markdown code snippet">
  <button class="highlight__copy" title="Copy to clipboard"></button><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># MULTI_QUERIES
</span></span></span><span class="line"><span class="cl"><span class="gh"></span><span class="s">```yaml
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Define multiple structured queries combined with UNION.&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;duckdb:&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">before_sql</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="s2">&#34;LOAD sqlite&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="s2">&#34;ATTACH &#39;reporting.db&#39; AS DB (TYPE SQLITE)&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">save_sql</span><span class="p">:</span><span class="w"> </span><span class="l">save_mult_query_res</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">save_on_err_patt</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;(?i)table.+with.+name.+(\w+).+does.+not.+exist&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">save_on_err_sql</span><span class="p">:</span><span class="w"> </span><span class="l">create_mult_query_res</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">after_sql</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;DETACH DB&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">union_key</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;UNION ALL\n&#34;</span><span class="w"> </span><span class="c"># Defaults to UNION.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```sql
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="c1">-- save_mult_query_res
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;DB&#34;</span><span class="p">.</span><span class="s2">&#34;MULTI_QUERY&#34;</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">NAME</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[[</span><span class="n">final_query</span><span class="p">]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl"><span class="s">```sql
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="c1">-- create_mult_query_res
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;DB&#34;</span><span class="p">.</span><span class="s2">&#34;MULTI_QUERY&#34;</span><span class="w"> </span><span class="k">AS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[[</span><span class="n">final_query</span><span class="p">]]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Row1
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="s">```yaml
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Row1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Row 1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="l">row_query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```sql
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="c1">-- row_query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;# number of rows&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Row2
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="s">```yaml
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Row2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Row 2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="l">row_query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```sql
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="c1">-- row_query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;total revenue&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="s2">&#34;total&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Row3
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="s">```yaml
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Row3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Row 3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="l">row_query</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```sql
</span></span></span><span class="line"><span class="cl"><span class="s"></span><span class="c1">-- row_query
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;region&#34;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="s2">&#34;total&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;region&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s">```</span></span></span></code></pre></td></tr></table>
</div>
</div></figure>
<hr>
<h4 id="multi-queries-how-it-works"><strong>Multi-Queries How It Works</strong></h4>
<ol>
<li>
<p><strong>Defining Queries</strong>:</p>
<ul>
<li>Queries are defined as Level 2 headings.</li>
<li>Each query can include its own metadata and SQL.</li>
</ul>
</li>
<li>
<p><strong>Combining Queries</strong>:</p>
<ul>
<li>All queries are combined using the <code>union_key</code> (e.g., <code>UNION</code> or <code>UNION ALL</code>).</li>
<li>The combined query is executed as a single statement.</li>
</ul>
</li>
<li>
<p><strong>Execution Flow</strong>:</p>
<ul>
<li>Executes the <code>before_sql</code> commands at the start.</li>
<li>Combines all active queries with the <code>union_key</code>.</li>
<li>Executes the combined query.</li>
<li>Executes the <code>after_sql</code> commands after the query execution.</li>
</ul>
</li>
</ol>
<hr>
<h4 id="multi-queries-example-use-case"><strong>Multi-Queries Example Use Case</strong></h4>
<p>For the example above:</p>
<ol>
<li><strong>Row1</strong>:
<ul>
<li>Counts the number of rows in the <code>sales</code> table.</li>
</ul>
</li>
<li><strong>Row2</strong>:
<ul>
<li>Calculates the total revenue from the <code>sales</code> table.</li>
</ul>
</li>
<li><strong>Row3</strong>:
<ul>
<li>Sums the revenue for each region in the <code>sales</code> table.</li>
</ul>
</li>
</ol>
<p>The resulting combined query:</p>
<figure class="code-block" role="figure" aria-label="sql code snippet">
  <button class="highlight__copy" title="Copy to clipboard"></button><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">LOAD</span><span class="w"> </span><span class="n">sqlite</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ATTACH</span><span class="w"> </span><span class="s1">&#39;reporting.db&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">DB</span><span class="w"> </span><span class="p">(</span><span class="k">TYPE</span><span class="w"> </span><span class="n">SQLITE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;# number of rows&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;total revenue&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="s2">&#34;total&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;region&#34;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;variable&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="s2">&#34;total&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;value&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sales&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;region&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DETACH</span><span class="w"> </span><span class="n">DB</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></figure>
<hr>
<h4 id="multi-queries-benefits"><strong>Multi-Queries Benefits</strong></h4>
<a
  class="edit-link"
  href="https://github.com/Dobefu/hugo-theme-plume/tree/main/exampleSite/content/configuration/multi-queries.md"
  rel="noopener noreferrer"
  target="_blank"
><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 20h4L18.5 9.5a2.828 2.828 0 1 0-4-4L4 16zm9.5-13.5l4 4"/></svg>
<span>Improve this page</span>
</a>
</main><aside id="toc" class="toc">
        <div class="toc__header" data-action="toggle-toc">
          <h3 class="toc__title">On this page</h3>

          <button
            class="toc__toggle"
            aria-label="Toggle table of contents"
          ></button>
        </div>

        <div class="toc__content"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#multi-queries">Multi-Queries</a>
          <ul>
            <li><a href="#multi-queries-structure"><strong>Multi-Queries Structure</strong></a></li>
            <li><a href="#multi-queries-markdown-example"><strong>Multi-Queries Markdown Example</strong></a></li>
            <li><a href="#multi-queries-how-it-works"><strong>Multi-Queries How It Works</strong></a></li>
            <li><a href="#multi-queries-example-use-case"><strong>Multi-Queries Example Use Case</strong></a></li>
            <li><a href="#multi-queries-benefits"><strong>Multi-Queries Benefits</strong></a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
      </aside><script defer src="/etlx/js/bundle.js"></script></body>
</html>
